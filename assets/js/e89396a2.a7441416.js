"use strict";(self.webpackChunkkunai_doc=self.webpackChunkkunai_doc||[]).push([[2604],{3905:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>m});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var c=a.createContext({}),d=function(e){var n=a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},l=function(e){var n=d(e.components);return a.createElement(c.Provider,{value:n},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},f=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=d(t),f=i,m=p["".concat(c,".").concat(f)]||p[f]||u[f]||o;return t?a.createElement(m,r(r({ref:n},l),{},{components:t})):a.createElement(m,r({ref:n},l))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,r=new Array(o);r[0]=f;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s[p]="string"==typeof e?e:i,r[1]=s;for(var d=2;d<o;d++)r[d]=t[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}f.displayName="MDXCreateElement"},7425:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=t(7462),i=(t(7294),t(3905));const o={sidebar_position:0},r="Event Layout and Info Section",s={unversionedId:"events/generalities",id:"events/generalities",title:"Event Layout and Info Section",description:"Every kunai event gets a set of common fields shared between all the events. These fields give various information which might be used for advanced purposes such as event identification, grouping or correlation.",source:"@site/docs/events/generalities.md",sourceDirName:"events",slug:"/events/generalities",permalink:"/docs/next/events/generalities",draft:!1,tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0},sidebar:"tutorialSidebar",previous:{title:"Kunai - Events",permalink:"/docs/next/category/kunai---events"},next:{title:"Execve",permalink:"/docs/next/events/execve"}},c={},d=[],l={toc:d},p="wrapper";function u(e){let{components:n,...t}=e;return(0,i.kt)(p,(0,a.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"event-layout-and-info-section"},"Event Layout and Info Section"),(0,i.kt)("p",null,"Every ",(0,i.kt)("strong",{parentName:"p"},"kunai")," event gets a set of common fields shared between all the events. These fields give various information which might be used for advanced purposes such as event identification, grouping or correlation."),(0,i.kt)("p",null,"For the general event layout, every event will have a ",(0,i.kt)("inlineCode",{parentName:"p"},"data")," section and an ",(0,i.kt)("inlineCode",{parentName:"p"},"info")," section. The ",(0,i.kt)("inlineCode",{parentName:"p"},"data"),"\xa0section might be different for every event family while the ",(0,i.kt)("inlineCode",{parentName:"p"},"info")," section will always be common (contains the same fields) across all the event types. This page only explains the ",(0,i.kt)("inlineCode",{parentName:"p"},"info")," section as ",(0,i.kt)("inlineCode",{parentName:"p"},"data")," sections will be addressed separately for each event documented."),(0,i.kt)("admonition",{title:"Process and Threads in Linux",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"In the Linux kernel, there is no notion of ",(0,i.kt)("strong",{parentName:"p"},"process")," or ",(0,i.kt)("strong",{parentName:"p"},"thread"),", everything is a ",(0,i.kt)("strong",{parentName:"p"},"task"),". So in the rest of the documentation we will consider that a ",(0,i.kt)("strong",{parentName:"p"},"process")," is made of ",(0,i.kt)("strong",{parentName:"p"},"one")," or ",(0,i.kt)("strong",{parentName:"p"},"several")," ",(0,i.kt)("strong",{parentName:"p"},"tasks")," belonging to the same ",(0,i.kt)("strong",{parentName:"p"},"thread-group"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": "...",\n  "info": {\n    // Host related information\n    "host": {\n      // Unique host uuid\n      "uuid": "b7ec95e3-b49f-57fa-b719-dea1c56f5448",\n      // Hostname of the host running kunai\n      "name": "whiterose",\n      // Container information if any, null otherwise\n      "container": {\n        // Name of the container\n        "name": "ubuntu-kunai-test",\n        // Type of container\n        "type": "docker"\n      }\n    },\n    // Event related information\n    "event": {\n      // A string which can be used by external tools to identify kunai\'s logs\n      "source": "kunai",\n      // Event type identifier\n      "id": 1,\n      // Event type name\n      "name": "execve",\n      // Unique identifier for an event\n      "uuid": "5c236371-d737-9deb-02ed-6964280720f1",\n      // Not relevant, here for diagnosis purposes\n      "batch": 44\n    },\n    // Information about the task generating this event\n    "task": {\n      // Task name\n      "name": "ls",\n      // Identifier\xa0of the task (process or thread)\n      "pid": 850464,\n      // Thread Group ID\xa0of the task (same for all threads of a process)\n      // When pid == tgid we are in the main thread.\n      "tgid": 850464,\n      // A uuid common to all the events generated by the same\n      // task group/process (i.e. all threads). You can search by\n      // this value in order to see the whole activity of a process\n      "guuid": "ba6b7593-a1ae-0000-373a-c0c420fa0c00",\n      // Effective uid of the task\n      "uid": 0,\n      // Effective gid of the task\n      "gid": 0,\n      // Information about Linux namespaces\n      "namespaces": {\n        // mnt namespace id\n        "mnt": 4026534135\n      },\n      // task_struct flags https://elixir.bootlin.com/linux/v6.6.5/source/include/linux/sched.h#L767\n      // combination of process flags https://elixir.bootlin.com/linux/v6.6.5/source/include/linux/sched.h#L1726\n      "flags": "0x400100"\n    },\n    // Information about the parent task. This section\n    // contains the same kind of information as the task section\n    "parent_task": {\n      "name": "containerd-shim",\n      "pid": 850441,\n      "tgid": 850441,\n      "guuid": "9584f090-a1ae-0000-373a-c0c409fa0c00",\n      "uid": 0,\n      "gid": 0,\n      "namespaces": {\n        "mnt": 4026531841\n      },\n      "flags": "0x400000"\n    },\n    "utc_time": "2024-02-14T13:56:19.519964995Z"\n  }\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n        ...\n    },\n  "info": {\n    // Host related information\n    "host": {\n      // Hostname of the workstation/container\n      "hostname": "bionic-container",\n      // Kind of container\n      "container": "lxc"\n    },\n    // Event related information\n    "event": {\n      // A string which can be used by external tools to identify kunai\'s logs\n      "source": "kunai",\n      // Event type identifier\n      "id": 1,\n      // Event type name\n      "name": "execve",\n      // Unique identifier for an event\n      "uuid": "605639f8-37b5-7df7-c52f-eda680a38124",\n      // Not relevant, here for diagnosis purposes\n      "batch": 21957\n    },\n    // Information about the task generating this event\n    "task": {\n      // Task name\n      "name": "systemd-tmpfile",\n      // Identifier\xa0of the task (process or thread)\n      "pid": 4308,\n      // Thread Group ID\xa0of the task (same for all threads of a process)\n      // When pid == tgid we are in the main thread.\n      "tgid": 4308,\n      // A uuid common to all the events generated by the same\n      // task group/process (i.e. all threads). You can search by\n      // this value in order to see the whole activity of a process\n      "guuid": "6629cda0-7300-0000-ba5f-b80ed4100000",\n      // Effective uid of the task\n      "uid": 1000000,\n      // Effective gid of the task\n      "gid": 1000000,\n      // Information about Linux namespaces\n      "namespaces": {\n        // mnt namespace id\n        "mnt": 4026532389\n      },\n      // task_struct flags https://elixir.bootlin.com/linux/v6.6.5/source/include/linux/sched.h#L767\n      // combination of process flags https://elixir.bootlin.com/linux/v6.6.5/source/include/linux/sched.h#L1726\n      "flags": "0x400000"\n    },\n    // Information about the parent task. This section\n    // contains the same kind of information as the task section\n    "parent_task": {\n      "name": "systemd",\n      "pid": 4154,\n      "tgid": 4154,\n      "guuid": "13729d78-7300-0000-ba5f-b80e3a100000",\n      "uid": 1000000,\n      "gid": 1000000,\n      "namespaces": {\n        "mnt": 4026532389\n      },\n      "flags": "0x400000"\n    },\n    // Time at which the event gets processed and printed.\n    "utc_time": "2023-06-26T07:12:55.030695982Z"\n  }\n}\n')),(0,i.kt)("admonition",{title:"container type is not identified properly",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"If you generated some activity within a container and the container type is not\ncorrect or empty please explain precisely your setup and we will fix this. Container identification is based on several string matching so every specific container implementation needs to be hardcoded. Even if the container type is not correct, all the rest of the event is correct and relative to your container.")))}u.isMDXComponent=!0}}]);