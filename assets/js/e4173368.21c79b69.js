"use strict";(self.webpackChunkkunai_doc=self.webpackChunkkunai_doc||[]).push([[3931],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>v});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=d(n),m=r,v=p["".concat(l,".").concat(m)]||p[m]||u[m]||i;return n?a.createElement(v,s(s({ref:t},c),{},{components:n})):a.createElement(v,s({ref:t},c))}));function v(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[p]="string"==typeof e?e:r,s[1]=o;for(var d=2;d<i;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4878:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:1100},s="Event Loss",o={unversionedId:"events/event_loss",id:"version-0.6.0/events/event_loss",title:"Event Loss",description:"This event is generated when Kunai detects that some events are lost between the kernel and Kunai userland. It reflects a scenario where the event monitor cannot keep up with the kernel's pace. Such occurrences are inevitable when Kunai is configured to log very frequent events, such as file system activities (read, write, filecreated, fileunlink, etc.). While these events are valuable for detailed analysis, the high frequency may lead to unavoidable losses.",source:"@site/versioned_docs/version-0.6.0/events/event_loss.md",sourceDirName:"events",slug:"/events/event_loss",permalink:"/docs/events/event_loss",draft:!1,editUrl:"https://github.com/kunai-project/kunai-doc/tree/main/versioned_docs/version-0.6.0/events/event_loss.md",tags:[],version:"0.6.0",sidebarPosition:1100,frontMatter:{sidebar_position:1100},sidebar:"tutorialSidebar",previous:{title:"Error",permalink:"/docs/events/error"},next:{title:"Threat Detection Usage",permalink:"/docs/advanced/"}},l={},d=[{value:"Example JSON",id:"example-json",level:2},{value:"Additional Details",id:"additional-details",level:2},{value:"Why This Event Matters",id:"why-this-event-matters",level:3},{value:"Throttling Mechanisms",id:"throttling-mechanisms",level:3},{value:"Key Fields Explained",id:"key-fields-explained",level:3},{value:"<code>.data.read</code>",id:"dataread",level:4},{value:"<code>.data.lost</code>",id:"datalost",level:4},{value:"<code>.data.eps</code>",id:"dataeps",level:4}],c={toc:d},p="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"event-loss"},"Event Loss"),(0,r.kt)("p",null,"This event is generated when ",(0,r.kt)("strong",{parentName:"p"},"Kunai")," detects that some events are lost between the kernel and Kunai userland. It reflects a scenario where the event monitor cannot keep up with the kernel's pace. Such occurrences are inevitable when Kunai is configured to log very frequent events, such as file system activities (",(0,r.kt)("inlineCode",{parentName:"p"},"read"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"write"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"file_created"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"file_unlink"),", etc.). While these events are valuable for detailed analysis, the high frequency may lead to unavoidable losses."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Event loss was always possible since kunai ",(0,r.kt)("inlineCode",{parentName:"p"},"v0.1.0")," this event is just here to bubble up event loss information into your favorite log storage.")),(0,r.kt)("h2",{id:"example-json"},"Example JSON"),(0,r.kt)("p",null,"Below is a sample JSON payload for an ",(0,r.kt)("inlineCode",{parentName:"p"},"event_loss"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "read": 75790,\n    "lost": 118,\n    "eps": 3568.562744844481\n  },\n  "info": {\n    "host": "...",\n    "event": {\n      "source": "kunai",\n      "id": 1100,\n      "name": "event_loss",\n      "uuid": "41fa8404-77b0-4971-a020-1b59f41619bb",\n      "batch": 1076\n    },\n    "task": "...",\n    "parent_task": "...",\n    "utc_time": "2025-01-17T14:16:35.430136639Z"\n  }\n}\n')),(0,r.kt)("h2",{id:"additional-details"},"Additional Details"),(0,r.kt)("h3",{id:"why-this-event-matters"},"Why This Event Matters"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"event_loss")," event highlights:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"System Performance Limits"),": Indicates situations where the userland application cannot match the kernel's event generation rate."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Configuration Impact"),": Emphasizes the importance of balanced configurations to minimize event loss while capturing essential data."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Monitoring Integrity"),": Provides a clear signal when event loss occurs, allowing administrators to adjust logging settings or analyze performance bottlenecks.")),(0,r.kt)("h3",{id:"throttling-mechanisms"},"Throttling Mechanisms"),(0,r.kt)("p",null,"Kunai includes ",(0,r.kt)("strong",{parentName:"p"},"throttling events"),", such as those reported in ",(0,r.kt)("a",{parentName:"p",href:"./error"},(0,r.kt)("inlineCode",{parentName:"a"},"error")," events"),", which are specifically designed to mitigate ",(0,r.kt)("strong",{parentName:"p"},"critical event")," loss. These mechanisms dynamically reduce the logging of excessively frequent events, balancing the system's monitoring capacity and performance."),(0,r.kt)("h3",{id:"key-fields-explained"},"Key Fields Explained"),(0,r.kt)("h4",{id:"dataread"},(0,r.kt)("inlineCode",{parentName:"h4"},".data.read")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The total number of events successfully processed by Kunai in the userland.")),(0,r.kt)("h4",{id:"datalost"},(0,r.kt)("inlineCode",{parentName:"h4"},".data.lost")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The total number of events that were lost.")),(0,r.kt)("h4",{id:"dataeps"},(0,r.kt)("inlineCode",{parentName:"h4"},".data.eps")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The rate of events processed per second, measured during the loss incident.")))}u.isMDXComponent=!0}}]);